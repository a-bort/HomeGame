extends layout

block content
    script(type="text/javascript" src="/javascripts/controllers/joinGameController.js")
    div(ng-controller="JoinGameController" ng-init="initWithGame(#{JSON.stringify(game)}, #{JSON.stringify(userAttending)}, #{JSON.stringify(autoJoin)})")
        div(ng-if="activeGame")
          div
            h2.content-head Game Info
            div.content-subhead {{activeGame.owner.displayName}}'s {{activeGame.stakes}}, {{activeGame.gameType}} {{activeGame.gameFormat}}
            div.game-grid.game-info
              div 
                span.strong-text When: 
                |{{activeGame.dateString}} @ {{activeGame.timeString}}
              div 
                span.strong-text Where: 
                | {{activeGame.location}}
              div {{activeGame.notes}}
            div(ng-show="!activeGame.pastGame")
              button.pure-button.pure-button-primary#join-button(ng-click="join()" ng-disabled="userAttending") {{joinButtonText()}}
              button.pure-button.pure-button-primary#cancel-button(ng-click="cancel()" ng-show="userAttending") Cancel Reservation
            div(ng-show="activeGame.pastGame")
              button.pure-button.button-error(disabled="true") Registration Closed
          div
            div.roster-panel
              h4.content-head Current Roster ({{activeGame.emptySeats}}&nbsp;/&nbsp;{{activeGame.seats}} Seats Remaining)
              div.roster-seat(ng-repeat="seat in activeGame.seatCollection | filter:filledSeatFilter")
                div.roster-image
                  img(ng-src="{{seat.user.imageUrl}}")
                div.roster-name {{seat.user.displayName}}
            div.roster-panel(ng-hide="emptySeats()")
              div.pure-u-3-5
                h4.content-head Waitlist
                div.roster-seat(ng-repeat="seat in activeGame.waitListCollection | orderBy: 'created'")
                  div.roster-image
                    img(ng-src="{{seat.user.imageUrl}}")
                  div.roster-name {{seat.user.displayName}}
            